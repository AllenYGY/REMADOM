data:
  source:
    path: data/paired_citeseq_small.h5ad
    batch_key: batch
    keys:
      rna: { X: "X", var_key: "gene_ids" }
      adt: { obsm: "X_adt", uns_key: "adt_names" }
  registry_path: runs/train_amp/registry.json

model:
  latent_bio: 16
  encoders:
    rna: { in_dim: 2000 }
    adt: { in_dim: 50 }
  decoders:
    rna: { out_dim: 2000, weight: 1.0 }
    adt: { out_dim: 50, weight: 0.75 }
  beta: 1.0
  beta_schedule: { kind: "linear", start: 0.0, end: 1.0, epochs: 10 }

alignment:
  mmd:
    enabled: true
    weight: 0.05
    bandwidth: 2.0

optim:
  lr: 1e-3
  weight_decay: 0.0
  epochs: 20
  batch_size: 512
  scheduler:
    name: warmup_cosine
    warmup_steps: 200
    min_lr: 1e-5
  clip:
    enabled: true
    max_norm: 1.0
  early_stopping:
    enabled: true
    patience: 5
    min_delta: 0.0005
  amp:
    enabled: true
    dtype: fp16

logging:
  run_dir: runs/train_amp