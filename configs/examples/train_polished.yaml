data:
  source:
    path: data/paired_citeseq_small.h5ad
    batch_key: batch
    keys:
      rna: { X: "X", var_key: "gene_ids" }
      adt: { obsm: "X_adt", uns_key: "adt_names" }

model:
  latent_bio: 16
  encoders:
    rna: { in_dim: 2000 }
    adt: { in_dim: 50 }
  decoders:
    rna: { out_dim: 2000, weight: 1.0, weight_schedule: { kind: "linear", start: 0.5, end: 1.0, epochs: 10 } }
    adt: { out_dim: 50, weight: 0.5, weight_schedule: { kind: "linear", start: 0.2, end: 0.5, epochs: 10 } }
  beta: 1.0
  beta_schedule: { kind: "linear", start: 0.0, end: 1.0, epochs: 20 }

alignment:
  ot:
    enabled: true
    weight: 0.05
    epsilon: 0.2
    schedule: { kind: "cosine", start: 0.2, end: 0.01, epochs: 20 }

optim:
  lr: 0.001
  weight_decay: 0.0
  epochs: 30
  batch_size: 512
  scheduler:
    name: warmup_cosine
    warmup_steps: 500
    total_steps: 15000   # optional; else auto-computed from data
    min_lr: 1e-5
  clip:
    enabled: true
    max_norm: 1.0
    norm_type: 2.0
  early_stopping:
    enabled: true
    metric: val_loss
    patience: 8
    min_delta: 0.0005

logging:
  run_dir: runs/train_polished